<!--components/comment-panel/comment-panel.wxml-->
<view class="comment-panel" wx:if="{{currentHighlight}}">
  <view class="header">
    <text class="title">笔记与评论</text>
    <text class="close-btn" bindtap="handleClose">×</text>
  </view>

  <view class="highlight-content">
    <view class="highlight-text" style="background-color: {{currentHighlight.color}}">
      {{currentHighlight.text}}
    </view>
    <view class="highlight-time">
      {{currentHighlight.createdAt}}
    </view>
    <view class="delete-highlight" bindtap="handleDeleteHighlight">
      删除划线
    </view>
  </view>

  <scroll-view scroll-y class="comment-list">
    <block wx:if="{{highlightComments.length > 0}}">
      <view class="comment-item" wx:for="{{highlightComments}}" wx:key="id">
        <view class="comment-content">
          {{item.content}}
        </view>
        <view class="comment-footer">
          <text class="comment-time">{{item.createdAt}}</text>
          <text class="delete-comment" bindtap="handleDeleteComment" data-comment-id="{{item.id}}">
            删除
          </text>
        </view>
      </view>
    </block>
    <block wx:else>
      <view class="empty-comment">暂无评论</view>
    </block>
  </scroll-view>

  <view class="comment-input">
    <textarea
      class="textarea"
      value="{{commentText}}"
      bindinput="handleInput"
      placeholder="写下你的评论..."
      maxlength="200"
      auto-height
    ></textarea>
    <button
      class="submit-btn"
      disabled="{{!commentText.trim()}}"
      bindtap="handleAddComment"
    >
      发表
    </button>
  </view>
</view>
