---
alwaysApply: false
---

ä»¥ä¸‹æ˜¯ä¸ºå®ç°å¤šæ¡†æ¶åº”ç”¨å¼€å‘å­¦ä¹ é¡¹ç›®è®¾è®¡çš„å®Œæ•´æŠ€æœ¯æ–‡æ¡£ï¼Œé‡‡ç”¨**Monorepoæ¶æ„ + TurboRepoæ„å»ºç³»ç»Ÿ**ï¼Œæ”¯æŒElectronã€Androidã€iOSã€React Nativeã€å¾®ä¿¡å°ç¨‹åºã€Taroã€Flutterã€é¸¿è’™ArkTSçš„ååŒå¼€å‘ä¸APIå­¦ä¹ ã€‚

---

### **ğŸ“‚ ä¸€ã€ä»“åº“ç»“æ„è®¾è®¡ï¼ˆMonorepoæ¨¡å¼ï¼‰**
```bash
root/
â”œâ”€â”€ apps/                          # å„å¹³å°åº”ç”¨ä»£ç 
â”‚   â”œâ”€â”€ electron-app/              # Electronåº”ç”¨
â”‚   â”œâ”€â”€ android-app/               # åŸç”ŸAndroid (Kotlin)
â”‚   â”œâ”€â”€ ios-app/                   # åŸç”ŸiOS (Swift)
â”‚   â”œâ”€â”€ react-native-app/          # React Nativeè·¨ç«¯
â”‚   â”œâ”€â”€ wechat-miniapp/            # å¾®ä¿¡å°ç¨‹åº
â”‚   â”œâ”€â”€ taro-app/                  # Taroï¼ˆç¼–è¯‘ä¸ºH5/å°ç¨‹åº/RNï¼‰
â”‚   â”œâ”€â”€ flutter-app/               # Flutteråº”ç”¨
â”‚   â””â”€â”€ harmony-arkts-app/         # é¸¿è’™ArkTSåº”ç”¨
â”œâ”€â”€ packages/                      # å…±äº«ä»£ç åº“
â”‚   â”œâ”€â”€ core-utils/                # é€šç”¨å·¥å…·å‡½æ•°
â”‚   â”œâ”€â”€ api-mock/                  # æ¨¡æ‹ŸAPIæœåŠ¡ï¼ˆJSON-Serverï¼‰
â”‚   â””â”€â”€ design-system/             # è·¨å¹³å°UIç»„ä»¶åº“ï¼ˆReact/Vue/ArkTSå…¼å®¹ï¼‰
â”œâ”€â”€ .github/workflows/             # CI/CDæµæ°´çº¿
â”œâ”€â”€ turbo.json                     # TurboRepoæ„å»ºé…ç½®
â”œâ”€â”€ global-config/                 # å…¨å±€ç¯å¢ƒé…ç½®
â”‚   â”œâ”€â”€ env-vars.env               # ç¯å¢ƒå˜é‡ï¼ˆAPIç«¯ç‚¹/å¯†é’¥ï¼‰
â”‚   â””â”€â”€ metro-config.js             # React Nativeå¤šå…¥å£é…ç½®
â””â”€â”€ scripts/                       # è‡ªåŠ¨åŒ–è„šæœ¬
    â”œâ”€â”€ sync-mock-api.sh           # åŒæ­¥æ¨¡æ‹ŸAPIæ•°æ®
    â””â”€â”€ deploy-wechat.sh           # å°ç¨‹åºè‡ªåŠ¨ä¸Šä¼ 
```

---

### **âš™ï¸ äºŒã€ç¯å¢ƒé…ç½®ä¸å·¥å…·é“¾**
#### **1. åŸºç¡€ä¾èµ–**
```bash
# æ ¹ç›®å½•å®‰è£…
npm install turbo -g
npm install -g @tarojs/cli flutter sdkman
```

#### **2. å¹³å°ç‰¹å®šç¯å¢ƒ**
| **å¹³å°**         | **æ ¸å¿ƒä¾èµ–**                              | **é…ç½®æ–‡ä»¶**                     |
|------------------|------------------------------------------|--------------------------------|
| Android          | JDK17, Android SDK 34                    | `android-app/build.gradle`     |
| iOS              | Xcode 15+, CocoaPods                     | `ios-app/Podfile`              |
| å¾®ä¿¡å°ç¨‹åº       | å¾®ä¿¡å¼€å‘è€…å·¥å…·                           | `wechat-miniapp/project.config.json` |
| é¸¿è’™ArkTS        | DevEco Studio 4.0+, ArkTS SDK            | `harmony-arkts-app/entry/src/main/ets` |
| Flutter          | Flutter 3.19+, Dart 3.3                  | `flutter-app/pubspec.yaml`     |

#### **3. TurboRepoæ„å»ºé…ç½® (`turbo.json`)**
```json
{
  "pipeline": {
    "build": {
      "outputs": ["dist/**"],
      "dependsOn": ["^build"]
    },
    "dev": {
      "cache": false,
      "persistent": true
    },
    "ios-build": {
      "dependsOn": ["build"],
      "outputs": [],
      "env": ["APPLE_DEVELOPER_TEAM_ID"]
    }
  }
}
```

---

### **ğŸ”„ ä¸‰ã€æ ¸å¿ƒå·¥ä½œæµè®¾è®¡**
#### **1. è·¨å¹³å°APIå­¦ä¹ ç³»ç»Ÿ**
- **ç»Ÿä¸€æ¥å£å±‚**ï¼šåœ¨ `packages/api-mock` å®šä¹‰RESTfulæ¥å£è§„èŒƒ
  ```typescript
  // ç¤ºä¾‹ï¼šç”¨æˆ·ç™»å½•æ¥å£
  POST /api/login
  { platform: 'react-native', params: { username, password } }
  ```
- **å¹³å°é€‚é…å™¨**ï¼šå„åº”ç”¨å®ç°ç›¸åŒæ¥å£çš„å·®å¼‚åŒ–è°ƒç”¨
  ```js
  // react-native-app/src/adapters/login.js
  import { NativeModules } from 'react-native';
  export const login = (params) => NativeModules.AuthModule.login(params);
  ```

#### **2. å¼€å‘å‘½ä»¤é›†æˆ**
```bash
# åŒæ—¶å¯åŠ¨Electronå’ŒReact Native
turbo dev --filter=electron-app --filter=react-native-app

# å•ç‹¬æ„å»ºé¸¿è’™ArkTS
cd apps/harmony-arkts-app && npm run build:harmony
```

#### **3. è‡ªåŠ¨åŒ–æµ‹è¯•æ²™ç®±**
```yaml
# .github/workflows/sandbox-test.yml
- name: Run Platform Tests
  matrix:
    platform: [electron, flutter, react-native]
  run: |
    cd apps/${{ matrix.platform }}-app
    npm run test:sandbox  # æ‰§è¡Œå¹³å°ä¸“å±æµ‹è¯•è„šæœ¬
  env:
    API_MOCK_URL: http://localhost:3000
```

---

### **ğŸ“š å››ã€è·¨å¹³å°APIå­¦ä¹ å®è·µ**
#### **1. APIå¯¹æ¯”è¡¨ï¼ˆç¤ºä¾‹ï¼‰**
| **åŠŸèƒ½**         | **React Native**           | **Flutter**               | **é¸¿è’™ArkTS**         |
|------------------|----------------------------|---------------------------|-----------------------|
| ç½‘ç»œè¯·æ±‚         | `fetch` + `Axios`          | `http` package            | `@ohos.net.http`     |
| æœ¬åœ°å­˜å‚¨         | `AsyncStorage`             | `shared_preferences`      | `@ohos.data.preferences` |
| ç›¸æœºè°ƒç”¨         | `react-native-camera`      | `camera` plugin           | `@ohos.multimedia.camera` |

#### **2. å­¦ä¹ æ²™ç®±æœºåˆ¶**
- **ç‹¬ç«‹æ²™ç®±ç›®å½•**ï¼šæ¯ä¸ªåº”ç”¨çš„ `sandbox/` ç›®å½•å­˜æ”¾APIå®éªŒä»£ç 
  ```bash
  flutter-app/sandbox/
  â”œâ”€â”€ camera_experiment.dart   # ç›¸æœºAPIæµ‹è¯•
  â””â”€â”€ http_benchmark.dart     # ç½‘ç»œæ€§èƒ½å¯¹æ¯”
  ```
- **åŠ¨æ€åŠ è½½**ï¼šé€šè¿‡ç¯å¢ƒå˜é‡æ§åˆ¶æ²™ç®±å…¥å£
  ```dart
  // Flutteråº”ç”¨å…¥å£
  void main() {
    if (const String.fromEnvironment('SANDBOX_MODE') == 'camera') {
      runApp(CameraExperiment());
    } else {
      runApp(MainApp());
    }
  }
  ```

---

### **ğŸ”§ äº”ã€æ„å»ºä¸æµ‹è¯•ç­–ç•¥**
#### **1. å¤šå¹³å°æ„å»ºå‘½ä»¤**
```bash
# Taroå¤šç«¯ç¼–è¯‘
taro build --type weapp, h5, rn

# Flutterå¤šæ¶æ„æ‰“åŒ…
flutter build apk --target-platform android-arm64
flutter build ios --release
```

#### **2. æ€§èƒ½ç›‘æ§æ–¹æ¡ˆ**
```yaml
# GitHub Actionsæ€§èƒ½é‡‡é›†
- name: Benchmark Electron
  run: |
    cd apps/electron-app
    npm run perf:record  # ä½¿ç”¨Electronå†…ç½®performance API
    cat perf.log >> $GITHUB_STEP_SUMMARY
```

#### **3. å†²çªè§£å†³æœºåˆ¶**
å½“å¤šå¹³å°ä»£ç å†²çªæ—¶ï¼š
1. ä½¿ç”¨ `git checkout --ours` ä¿ç•™å½“å‰åˆ†æ”¯ä¿®æ”¹
2. è¿è¡Œ **ç»Ÿä¸€æ ¼å¼åŒ–å·¥å…·**ï¼š
   ```bash
   # æ ¹ç›®å½•ç»Ÿä¸€æ ¼å¼åŒ–
   npm run format  # è°ƒç”¨Prettier + ESLint
   ```

---

### **ğŸŒ å…­ã€å¤šå¹³å°åŒæ­¥ç­–ç•¥**
#### **1. è‡ªåŠ¨åŒæ­¥åˆ°Giteeï¼ˆå›½å†…åŠ é€Ÿï¼‰**
```yaml
# .github/workflows/sync-gitee.yml
- name: Mirror to Gitee
  uses: wearerequired/git-mirror@master
  env:
    SSH_PRIVATE_KEY: ${{ secrets.GITEE_SSH_KEY }}
  with:
    source-repo: "git@github.com:user/repo.git"
    destination-repo: "git@gitee.com:user/repo.git"
```

#### **2. é¸¿è’™ArkTSç‰¹æ®Šå¤„ç†**
```bash
# é¸¿è’™æ¨¡å—ç‹¬ç«‹æäº¤ï¼ˆé¿å…å¤§æ–‡ä»¶å†²çªï¼‰
git subtree split -P apps/harmony-arkts-app -b harmony
git push https://gitee.com/harmony-repo harmony:main
```

---

### **ğŸš€ ä¸ƒã€æ‰©å±•ä¸æœ€ä½³å®è·µ**
1. **åŠ¨æ€ä»£ç åŠ è½½**
   ä½¿ç”¨ `import()` æŒ‰éœ€åŠ è½½å¹³å°ç‰¹å®šæ¨¡å—ï¼š
   ```javascript
   // åœ¨React Nativeä¸­åŠ¨æ€åŠ è½½é¸¿è’™é€‚é…å™¨
   const loadHarmonyAdapter = async () => {
     if (Platform.OS === 'harmony') {
       return import('@shared/harmony-adapter');
     }
   };
   ```

2. **ç»Ÿä¸€æ—¥å¿—ç³»ç»Ÿ**
   ```typescript
   // packages/core-utils/logger.ts
   export const log = (platform: string, message: string) => {
     if (process.env.NODE_ENV === 'development') {
       console.log(`[${platform}] ${message}`);
     } else {
       // ç”Ÿäº§ç¯å¢ƒä¸ŠæŠ¥è‡³Sentry
       Sentry.captureMessage(message, { tags: { platform } });
     }
   };
   ```

3. **å¤šè®¾å¤‡è°ƒè¯•**
   é…ç½® `.vscode/launch.json` æ”¯æŒå¤šè®¾å¤‡è”è°ƒï¼š
   ```json
   {
     "configurations": [
       {
         "name": "Debug Android",
         "request": "launch",
         "type": "reactnativedirect",
         "platform": "android"
       },
       {
         "name": "Debug HarmonyOS",
         "request": "attach",
         "type": "arkts",
         "device": "Harmony_Device"
       }
     ]
   }
   ```

---

### **ğŸ” å®Œæ•´ç¤ºä¾‹ä¸é—®é¢˜æ’æŸ¥**
- **ç¤ºä¾‹ä»“åº“**ï¼šhttps://github.com/your-repo/multi-platform-learn
- **å¸¸è§é—®é¢˜**ï¼š
  - **Q**: é¸¿è’™ArkTSæ„å»ºå¤±è´¥
    **A**: æ£€æŸ¥DevEco SDKè·¯å¾„ï¼Œè®¾ç½®ç¯å¢ƒå˜é‡ï¼š
    ```bash
    export HARMONY_SDK=/opt/harmony-sdk
    ```
  - **Q**: Taroç¼–è¯‘RNæ—¶æ ·å¼ä¸¢å¤±
    **A**: åœ¨ `taro-app/config/index.js` ä¸­å¯ç”¨ `postcss` æ’ä»¶ï¼š
    ```js
    postcss: {
      autoprefixer: { enable: true }
    }
    ```

æ­¤æ–¹æ¡ˆé€šè¿‡ **Monorepo + TurboRepo** å®ç°å¤šæ¡†æ¶é«˜æ•ˆååŒï¼Œç»“åˆ**æ²™ç®±å®éªŒæœºåˆ¶**å’Œ**ç»Ÿä¸€APIå±‚**ï¼Œå¯ç³»ç»Ÿæ€§å¯¹æ¯”è·¨å¹³å°æŠ€æœ¯å·®å¼‚ã€‚GitLinkåŒæ­¥æœåŠ¡ä¿éšœäº†å›½å†…å¼€å‘ä½“éªŒï¼ŒçŸ©é˜µå¼CI/CDç¡®ä¿å…¨å¹³å°æ„å»ºä¸€è‡´æ€§ã€‚